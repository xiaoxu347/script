-- LocalScript 放置在 StarterPlayerScripts 中
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- 获取本地玩家
local localPlayer = Players.LocalPlayer
local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- 手动指定目标玩家
local targetPlayer = Players:FindFirstChild("yaoshen21") -- 替换成目标玩家的名字
if not targetPlayer then
    warn("找不到目标玩家")
    return
end

local targetCharacter = targetPlayer.Character or targetPlayer.CharacterAdded:Wait()
local targetRootPart = targetCharacter:WaitForChild("HumanoidRootPart")

-- 禁用本地玩家的移动控制
localPlayer.Character.HumanoidRootPart.Anchored = true

-- 设置相对位置偏移
local offset = Vector3.new(-3, 3, -2) -- 左边并漂浮的位置
local smoothingFactor = 0.1 -- 插值平滑因子，数值越小越平滑

-- 禁用物理碰撞
character.HumanoidRootPart.CanCollide = false

-- 更新替身位置和方向
RunService.RenderStepped:Connect(function()
    if targetRootPart then
        -- 计算目标玩家的位置和方向
        local targetPosition = targetRootPart.Position
        local targetCFrame = targetRootPart.CFrame
        local targetLookVector = targetCFrame.LookVector

        -- 计算目标位置
        local desiredPosition = targetPosition + (targetLookVector * offset.Z) + (targetCFrame.RightVector * offset.X) + Vector3.new(0, offset.Y, 0)
        
        -- 使用插值平滑移动替身位置
        local currentPosition = humanoidRootPart.Position
        local smoothPosition = currentPosition:Lerp(desiredPosition, smoothingFactor)

        -- 更新当前玩家的位置
        humanoidRootPart.CFrame = CFrame.new(smoothPosition, targetPosition)
    end
end)
