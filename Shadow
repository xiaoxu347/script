local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- 定义本地玩家和目标玩家
local localPlayer = Players.LocalPlayer
local targetPlayer = Players:FindFirstChild("yaoshen21") -- 替换为目标玩家名称

-- 等待角色加载完成
local function waitForCharacter(player)
    while not player.Character do
        player.CharacterAdded:Wait()
    end
    return player.Character
end

-- 等待本地玩家和目标玩家角色加载
local localCharacter = waitForCharacter(localPlayer)
local targetCharacter = waitForCharacter(targetPlayer)

-- 获取人形根部件
local localHumanoidRootPart = localCharacter:WaitForChild("HumanoidRootPart")
local targetHumanoidRootPart = targetCharacter:WaitForChild("HumanoidRootPart")

-- 创建 BodyPosition 和 BodyGyro 控制位置和方向
local bodyPosition = Instance.new("BodyPosition")
bodyPosition.MaxForce = Vector3.new(4000, 4000, 4000) -- 设置最大施力
bodyPosition.P = 3000 -- 控制力度
bodyPosition.D = 100 -- 控制阻尼
bodyPosition.Position = targetHumanoidRootPart.Position + Vector3.new(5, 5, 5) -- 初始位置在目标玩家头上

local bodyGyro = Instance.new("BodyGyro")
bodyGyro.MaxTorque = Vector3.new(4000, 4000, 4000) -- 设置最大旋转力
bodyGyro.P = 3000 -- 控制旋转力度
bodyGyro.CFrame = CFrame.new(localHumanoidRootPart.Position, targetHumanoidRootPart.Position) -- 面向目标玩家

-- 将 BodyPosition 和 BodyGyro 绑定到本地玩家的 HumanoidRootPart
bodyPosition.Parent = localHumanoidRootPart
bodyGyro.Parent = localHumanoidRootPart

-- 更新位置和方向的函数
local function updatePositionAndRotation()
    if targetHumanoidRootPart and localHumanoidRootPart then
        -- 设置漂浮位置在目标玩家头上
        bodyPosition.Position = targetHumanoidRootPart.Position + Vector3.new(0, 5, 0)
        -- 设置面向目标玩家
        bodyGyro.CFrame = CFrame.new(localHumanoidRootPart.Position, targetHumanoidRootPart.Position)
    end
end

-- 每帧更新玩家位置和方向
RunService.RenderStepped:Connect(updatePositionAndRotation)
