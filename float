-- 获取玩家
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- 获取身体部分
local humanoid = character:FindFirstChildOfClass("Humanoid")
local rootPart = character:FindFirstChild("HumanoidRootPart")

-- 设定漂浮参数
local floatHeight = 3 -- 漂浮的高度
local isFloating = false -- 控制是否漂浮

-- 创建用于漂浮的BodyPosition和BodyGyro
local bodyPosition = Instance.new("BodyPosition", rootPart)
local bodyGyro = Instance.new("BodyGyro", rootPart)

-- 设置BodyPosition的属性，控制玩家的漂浮高度
bodyPosition.MaxForce = Vector3.new(0, math.huge, 0) -- 仅在Y轴上施加力
bodyPosition.Position = rootPart.Position + Vector3.new(0, floatHeight, 0) -- 将玩家漂浮到指定高度
bodyPosition.D = 3 -- 让玩家缓慢地达到目标高度

-- 设置BodyGyro的属性，保持玩家的旋转
bodyGyro.MaxTorque = Vector3.new(math.huge, math.huge, math.huge) -- 允许沿所有轴旋转
bodyGyro.D = 10

-- 正确设置CFrame使玩家完全躺平面朝天
local layDownCFrame = rootPart.CFrame * CFrame.Angles(math.rad(90), 0, 0) -- X轴旋转90度，保证玩家躺下
bodyGyro.CFrame = layDownCFrame

-- 漂浮逻辑
local function startFloating()
    if not isFloating then
        isFloating = true

        -- 禁用玩家动画防止游泳等动画影响
        if humanoid:FindFirstChild("Animator") then
            humanoid.Animator:Destroy()
        end

        -- 禁用玩家的物理行为防止干扰
        humanoid.PlatformStand = true

        -- 确保玩家在漂浮时不会掉下去
        bodyPosition.Position = rootPart.Position + Vector3.new(0, floatHeight, 0)
    end
end

local function stopFloating()
    if isFloating then
        isFloating = false

        -- 恢复原来的状态
        humanoid.PlatformStand = false
        bodyPosition:Destroy()
        bodyGyro:Destroy()
    end
end

-- 让玩家漂浮并面朝天躺下
startFloating()

-- 设置10秒后停止漂浮
wait(10)
stopFloating()
