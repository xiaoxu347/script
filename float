-- 创建 GUI
local screenGui = Instance.new("ScreenGui")
local buttonFrame = Instance.new("Frame")
buttonFrame.Size = UDim2.new(0, 200, 0, 200)
buttonFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
buttonFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
buttonFrame.Parent = screenGui

-- 创建浮动按钮
local floatButton = Instance.new("TextButton")
floatButton.Size = UDim2.new(0, 100, 0, 50)
floatButton.Position = UDim2.new(0, 0, 0, 0)
floatButton.Text = "Float"
floatButton.Parent = buttonFrame

-- 创建取消按钮
local cancelButton = Instance.new("TextButton")
cancelButton.Size = UDim2.new(0, 100, 0, 50)
cancelButton.Position = UDim2.new(0, 0, 0, 50)
cancelButton.Text = "Cancel"
cancelButton.Parent = buttonFrame

-- 创建上升按钮
local flyUpButton = Instance.new("TextButton")
flyUpButton.Size = UDim2.new(0, 100, 0, 50)
flyUpButton.Position = UDim2.new(0, 0, 0, 100)
flyUpButton.Text = "Fly Up"
flyUpButton.Parent = buttonFrame

-- 创建下降按钮
local flyDownButton = Instance.new("TextButton")
flyDownButton.Size = UDim2.new(0, 100, 0, 50)
flyDownButton.Position = UDim2.new(0, 0, 0, 150)
flyDownButton.Text = "Fly Down"
flyDownButton.Parent = buttonFrame

-- 创建前进按钮
local moveForwardButton = Instance.new("TextButton")
moveForwardButton.Size = UDim2.new(0, 100, 0, 50)
moveForwardButton.Position = UDim2.new(0, 100, 0, 0)
moveForwardButton.Text = "Forward"
moveForwardButton.Parent = buttonFrame

-- 创建最小化按钮
local minimizeButton = Instance.new("TextButton")
minimizeButton.Size = UDim2.new(0, 20, 0, 20)
minimizeButton.Position = UDim2.new(1, -20, 0, 0)
minimizeButton.Text = "-"
minimizeButton.Parent = buttonFrame

-- GUI 显示隐藏状态
local isMinimized = false

-- 最小化功能
minimizeButton.MouseButton1Click:Connect(function()
    if isMinimized then
        buttonFrame.Size = UDim2.new(0, 200, 0, 200)
        minimizeButton.Text = "-"
    else
        buttonFrame.Size = UDim2.new(0, 200, 0, 20)
        minimizeButton.Text = "+"
    end
    isMinimized = not isMinimized
end)

-- 将 GUI 添加到玩家的屏幕
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- 拖动功能
local dragging
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    buttonFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

buttonFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = buttonFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

buttonFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- 功能实现
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("HumanoidRootPart")

-- 按钮连接到动作
local floating = false
local floatHeight = 50
local moveSpeed = 10

-- 浮动功能
floatButton.MouseButton1Click:Connect(function()
    floating = true
    humanoid.BodyVelocity = Instance.new("BodyVelocity", humanoid)
    humanoid.BodyVelocity.Velocity = Vector3.new(0, 1, 0) * floatHeight
end)

-- 取消浮动
cancelButton.MouseButton1Click:Connect(function()
    floating = false
    if humanoid:FindFirstChild("BodyVelocity") then
        humanoid.BodyVelocity:Destroy()
    end
end)

-- 上升功能
flyUpButton.MouseButton1Click:Connect(function()
    humanoid.CFrame = humanoid.CFrame * CFrame.new(0, moveSpeed, 0)
end)

-- 下降功能
flyDownButton.MouseButton1Click:Connect(function()
    humanoid.CFrame = humanoid.CFrame * CFrame.new(0, -moveSpeed, 0)
end)

-- 前进功能
moveForwardButton.MouseButton1Click:Connect(function()
    humanoid.CFrame = humanoid.CFrame * CFrame.new(0, 0, -moveSpeed)
end)
