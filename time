local Players = game:GetService("Players")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

local animations = {}
local isStopped = false
local originalStates = {}
local tools = {}

-- 创建 GUI
local function createGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = player:WaitForChild("PlayerGui")

    local toggleButton = Instance.new("TextButton")
    toggleButton.Size = UDim2.new(0, 200, 0, 50)
    toggleButton.Position = UDim2.new(0.5, -100, 0.1, 0)
    toggleButton.Text = "Stop Action"
    toggleButton.Parent = screenGui
    toggleButton.Active = true
    toggleButton.Draggable = true

    toggleButton.MouseButton1Click:Connect(function()
        if isStopped then
            resumeAction()
        else
            stopAction()
        end
    end)
end

-- 停止角色行动
local function stopAction()
    if isStopped then return end
    isStopped = true

    -- 停止所有动画
    for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do
        track:Stop()
        table.insert(animations, track)
    end

    -- 停止角色移动
    humanoid.WalkSpeed = 0
    humanoid.JumpPower = 0

    -- 保存并停止角色物理状态
    for _, part in ipairs(character:GetDescendants()) do
        if part:IsA("BasePart") then
            originalStates[part] = part.Anchored
            part.Anchored = true
        end
    end

    -- 禁用工具
    for _, tool
